SELECT * FROM PS_UD_OLA_PSC_HDR2;
DELETE FROM PS_UD_OLA_PSC_HDR2 WHERE EFF_STATUS = 'I';
INSERT INTO PS_UD_OLA_PSC_HDR2 VALUES ('DERBY', 2015, 'I', TO_DATE('2015/10/01', 'yyyy/mm/dd'));
INSERT INTO PS_UD_OLA_PSC_HDR2 VALUES ('DERBY', 2016, 'A', TO_DATE('2015/08/01', 'yyyy/mm/dd'));
INSERT INTO PS_UD_OLA_PSC_HDR2 VALUES ('DERBY', 2016, 'I', TO_DATE('2016/01/01', 'yyyy/mm/dd'));
COMMIT;

SELECT * FROM PS_ACAD_PROG_TBL WHERE ACAD_PROG = 'Y002';
SELECT * FROM PS_UD_OLA_PSC_PROG WHERE STRM = 2016 AND ACAD_PROG = 'B770';
SELECT * FROM PS_UD_OLA_PSC_PLAN WHERE STRM = 2016;
SELECT * FROM PS_UD_OLA_PSC_ADMT WHERE STRM = 2016;
SELECT * FROM PS_UD_OLA_PSC_MODE WHERE STRM = 2016;
SELECT * FROM PS_UD_OLA_PSC_POE WHERE STRM = 2016;

-- SHOW ROW IF ACTIVE AND MAX EFFDT
SELECT * FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT IN (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE A.STRM = B.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A';

-- SHOW PROG
SELECT * FROM PS_UD_OLA_PSC_PROG
WHERE ACAD_PROG = 'Y002'
AND EFF_STATUS = 'A'
AND EXCLUDE = 'N'
AND STRM IN 
(SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE A.STRM = B.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

--SHOW PLAN
--SELECT DISTINCT ACAD_PLAN, ADM_APPL_CTR, UD_OLA_PLAN_TITLE FROM PS_UD_OLA_PSC_PLAN
SELECT DISTINCT B.ACAD_PLAN, B.ADM_APPL_CTR, B.UD_OLA_PLAN_TITLE, B.CAMPUS, C.DESCR254_MIXED FROM PS_UD_OLA_PSC_PLAN B, PS_ACAD_PROG_TBL C
WHERE B.ACAD_PROG = 'B770'
AND C.ACAD_PROG = B.ACAD_PROG
AND B.INSTITUTION = 'DERBY'
AND B.EFF_STATUS = 'A'
AND B.STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = INSTITUTION
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.STRM = A.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A')
AND C.EFFDT = (SELECT MAX(C1.EFFDT) FROM PS_ACAD_PROG_TBL C1 WHERE C1.INSTITUTION = C.INSTITUTION AND C1.ACAD_PROG = C.ACAD_PROG AND C1.EFF_STATUS = 'A' AND C1.EFFDT <=SYSDATE);


-- ADMIT TYPE (MONTH START)
--SELECT DISTINCT STRM, ACAD_PROG, ACAD_PLAN, ADM_APPL_CTR, ADMIT_TYPE FROM PS_UD_OLA_PSC_ADMT
SELECT * FROM PS_UD_OLA_PSC_ADMT
WHERE ACAD_PROG = 'B770'
AND ACAD_PLAN = 'B7703'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.STRM = A.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

-- FULL TIME PART TIME
SELECT * FROM PS_UD_OLA_PSC_MODE
WHERE ACAD_PROG = 'B770'
AND ACAD_PLAN = 'B7703'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.STRM = A.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

-- ACADEMIC LEVEL (ENTRY LEVEL) & CAMPUS
SELECT * FROM PS_UD_OLA_PSC_POE
WHERE ACAD_PROG = 'B770'
AND ACAD_PLAN = 'B7703'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

--Y002
--Y002F
--Y004

SELECT * FROM PS_UD_OLA_PSC_PLAN WHERE STRM = '2016' AND ACAD_PROG = 'Y002'
AND (ACAD_PLAN LIKE '_SUJ__J' OR ACAD_PLAN LIKE '___JSUJ');

