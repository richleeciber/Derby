SELECT * FROM PS_UD_OLA_PSC_HDR2;
DELETE FROM PS_UD_OLA_PSC_HDR2 WHERE EFF_STATUS = 'I';
INSERT INTO PS_UD_OLA_PSC_HDR2 VALUES ('DERBY', 2015, 'I', TO_DATE('2015/10/01', 'yyyy/mm/dd'));
INSERT INTO PS_UD_OLA_PSC_HDR2 VALUES ('DERBY', 2016, 'A', TO_DATE('2015/08/01', 'yyyy/mm/dd'));
INSERT INTO PS_UD_OLA_PSC_HDR2 VALUES ('DERBY', 2016, 'I', TO_DATE('2016/01/01', 'yyyy/mm/dd'));
COMMIT;

SELECT * FROM PS_ACAD_PROG_TBL WHERE ACAD_PROG = 'B770';
SELECT * FROM PS_UD_OLA_PSC_PROG WHERE STRM = 2016 AND ACAD_PROG = 'B770';
SELECT * FROM PS_UD_OLA_PSC_PLAN WHERE STRM = 2016;
SELECT * FROM PS_UD_OLA_PSC_ADMT WHERE STRM = 2016;
SELECT * FROM PS_UD_OLA_PSC_MODE WHERE STRM = 2016;
SELECT * FROM PS_UD_OLA_PSC_POE WHERE STRM = 2016;


-- SHOW ROW IF ACTIVE AND MAX EFFDT
SELECT * FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT IN (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE A.STRM = B.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A';

-- SHOW PROG
SELECT * FROM PS_UD_OLA_PSC_PROG
WHERE ACAD_PROG = 'C300'
AND EFF_STATUS = 'A'
AND EXCLUDE = 'N'
AND STRM IN 
(SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE A.STRM = B.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

--SHOW PLAN
--SELECT DISTINCT ACAD_PLAN, ADM_APPL_CTR, UD_OLA_PLAN_TITLE FROM PS_UD_OLA_PSC_PLAN
SELECT * FROM PS_UD_OLA_PSC_PLAN
WHERE ACAD_PROG = 'C300'
AND INSTITUTION = 'DERBY'
AND EFF_STATUS = 'A'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = INSTITUTION
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.STRM = A.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');


-- ADMIT TYPE (MONTH START)
--SELECT DISTINCT STRM, ACAD_PROG, ACAD_PLAN, ADM_APPL_CTR, ADMIT_TYPE FROM PS_UD_OLA_PSC_ADMT
SELECT * FROM PS_UD_OLA_PSC_ADMT
WHERE ACAD_PROG = 'B770'
AND ACAD_PLAN = 'B7703'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.STRM = A.STRM AND B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

-- FULL TIME PART TIME
SELECT * FROM PS_UD_OLA_PSC_MODE
WHERE ACAD_PROG = 'C300'
AND ACAD_PLAN = 'C3003'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

-- ACADEMIC LEVEL (ENTRY LEVEL) & CAMPUS
SELECT * FROM PS_UD_OLA_PSC_POE
WHERE ACAD_PROG = 'B770'
AND ACAD_PLAN = 'B7703'
AND STRM IN (SELECT A.STRM FROM PS_UD_OLA_PSC_HDR2 A 
WHERE A.INSTITUTION = 'DERBY'
AND A.EFFDT = (SELECT MAX(B.EFFDT) FROM PS_UD_OLA_PSC_HDR2 B WHERE B.INSTITUTION = A.INSTITUTION AND B.EFFDT <= SYSDATE)
AND A.EFF_STATUS = 'A');

